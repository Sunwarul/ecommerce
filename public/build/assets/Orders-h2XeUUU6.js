import{s as qe,a as Ge}from"./index-DIiKZPDj.js";import{O as Ee,r as c,f as x,I as F,o as r,w as v,b as t,a as o,e as p,t as d,u as a,S as We,d as f,c as b,F as ge,i as Ve,W as T}from"./app-C0cgKEVJ.js";import{_ as ze}from"./AuthenticatedLayout-BaSUhMCN.js";import{a as i}from"./index-BrdrWM5Y.js";import{s as ke}from"./index-DZURpK-h.js";import{a as Ke,s as S}from"./index-C9oOZDN3.js";import{s as q}from"./index-1aIBLaft.js";import{s as Ce,a as G}from"./index-CXWVQFAa.js";import{s as E}from"./index-CEUOXfel.js";import{s as W}from"./index-Bqd9hyBX.js";import{s as _}from"./index-CbEqa0vW.js";import"./index-CZnd7t6v.js";import"./index-DchAFvzt.js";import"./index-RF1b40_i.js";import"./index-Bq_PLBQx.js";import"./index-DguU-g0e.js";import"./index-Do0mVlXl.js";import"./index-HU_mUv9Y.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./FavIcons-xHxhwu_P.js";import"./index-DB_Lcll3.js";import"./index-AHsjsjwe.js";import"./index-C4az3xXa.js";import"./index-CASaY_cd.js";import"./index-BXXQtM63.js";import"./index-DoFtRZeu.js";import"./index-BhqVbYAE.js";import"./index-KEq5E4jG.js";const Ye={class:"p-4 md:p-6 space-y-4"},He={class:"flex justify-between flex-wrap gap-3"},Je={class:"px-4 py-2 rounded-xl bg-emerald-50 text-emerald-700 text-sm font-semibold"},Qe={class:"card p-3 flex flex-wrap gap-3 items-center"},Xe={class:"card"},Ze={class:"flex flex-col"},et={class:"font-semibold text-slate-800"},tt={class:"text-xs text-slate-500"},lt={class:"font-semibold text-emerald-600"},st={class:"flex gap-1 flex-wrap"},at={class:"flex justify-between items-center mt-3 text-sm text-gray-500"},ot={class:"flex gap-1"},nt={key:0,class:"space-y-3"},dt={class:"flex justify-between gap-3 flex-wrap"},it={class:"text-xl font-bold"},ut={class:"text-xs text-gray-500"},rt={class:"flex gap-2"},mt={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},pt={class:"p-3 border rounded-lg"},ct={class:"font-medium"},vt={class:"p-3 border rounded-lg"},ft={class:"capitalize"},bt={class:"capitalize"},xt={key:0,class:"space-y-3"},yt={class:"text-sm"},_t={class:"flex justify-end gap-2"},gt={key:0,class:"space-y-4"},Vt={class:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm"},kt={class:"p-3 border rounded-lg"},Ct={class:"font-semibold"},wt={class:"p-3 border rounded-lg"},ht={class:"font-semibold"},Ut={class:"p-3 border rounded-lg"},St={key:0,class:"font-semibold text-rose-600"},$t={key:1,class:"font-semibold text-emerald-600"},Dt={key:2,class:"font-semibold text-slate-700"},Pt={class:"flex items-center justify-between"},Ft={class:"space-y-3"},Tt={class:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end"},Nt={class:"flex gap-2 justify-end"},At={class:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3"},Mt={key:0,class:"mt-3 rounded-lg border bg-slate-50 p-3"},It={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Ot={class:"flex justify-end gap-2"},Bt={key:0,class:"space-y-4"},jt={class:"p-3 rounded-xl border bg-amber-50 border-amber-200 text-amber-900 text-sm"},Lt={class:"text-xs mt-1"},Rt={key:0},qt={class:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm"},Gt={class:"p-3 border rounded-lg"},Et={class:"font-semibold"},Wt={class:"p-3 border rounded-lg"},zt={class:"font-semibold"},Kt={class:"p-3 border rounded-lg"},Yt={class:"font-semibold"},Ht={class:"flex items-center justify-between"},Jt={class:"space-y-3"},Qt={class:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end"},Xt={class:"flex gap-2 justify-end"},Zt={class:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3"},el={key:0,class:"mt-3 rounded-lg border bg-slate-50 p-3"},tl={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ll={class:"flex justify-end gap-2"},Fl={__name:"Orders",props:{orders:Object,filters:Object,paymentMethods:{type:Array,default:()=>[]}},setup(g){var fe,be,xe,ye,_e;const k=Ee(),V=g,j=c(((fe=V.filters)==null?void 0:fe.search)||""),L=c(((be=V.filters)==null?void 0:be.status)||""),R=c(((xe=V.filters)==null?void 0:xe.payment_status)||""),N=c((ye=V.filters)!=null&&ye.date_from?new Date(V.filters.date_from):null),A=c((_e=V.filters)!=null&&_e.date_to?new Date(V.filters.date_to):null),we=[{label:"All",value:""},{label:"Completed",value:"completed"},{label:"Draft",value:"draft"},{label:"Void",value:"void"}],he=[{label:"All",value:""},{label:"Paid",value:"paid"},{label:"Partial",value:"partial"},{label:"Unpaid",value:"unpaid"}];function te(s){if(!s)return;const e=s.getFullYear(),h=String(s.getMonth()+1).padStart(2,"0"),m=String(s.getDate()).padStart(2,"0");return`${e}-${h}-${m}`}function le(){T.get(route("pos.orders.index"),{search:j.value||void 0,status:L.value||void 0,payment_status:R.value||void 0,date_from:N.value?te(N.value):void 0,date_to:A.value?te(A.value):void 0},{preserveState:!0,replace:!0})}function Ue(){j.value="",L.value="",R.value="",N.value=null,A.value=null,T.get(route("pos.orders.index"),{},{replace:!0})}function se(s){s&&T.get(s,{},{preserveState:!0})}const ae=x(()=>{var s;return((s=V.orders)==null?void 0:s.data)||[]}),Se=x(()=>ae.value.reduce((s,e)=>s+Number(e.total_amount||0),0));function M(s){return s?s.invoice_no||(s.status==="draft"?`DRAFT-${s.id}`:`#${s.id}`):""}function oe(s){window.open(route("pos.orders.invoice",s.id),"_blank")}function ne(s){window.open(route("pos.orders.invoice",s.id)+"?autoprint=1","_blank")}function $e(s){return s==="paid"?"success":s==="partial"?"warn":"danger"}function De(s){return s==="completed"?"success":s==="draft"?"info":"danger"}const z=c(!1),y=c(null);function Pe(s){y.value=s,z.value=!0}function $(){var s;return{id:((s=crypto==null?void 0:crypto.randomUUID)==null?void 0:s.call(crypto))||String(Date.now()+Math.random()),payment_method_id:null,amount:0,transaction_ref:"",notes:"",meta:{customer_bank_name:"",customer_account_no:"",received_to_bank_account_id:null,txn_ref:""}}}function de(s){s.value.push($())}function ie(s,e){if(s.value.length===1){s.value=[$()];return}s.value.splice(e,1)}function K(s){const e=V.paymentMethods.find(m=>m.id===s.payment_method_id),h=((e==null?void 0:e.name)||"").toLowerCase();return h.includes("bank")||h.includes("transfer")}const I=c(!1),C=c(null),Y=c(!1);function Fe(s){return(s==null?void 0:s.status)!=="void"}function Te(s){C.value=s,I.value=!0}function Ne(){C.value&&(Y.value=!0,T.post(route("pos.orders.void",C.value.id),{},{preserveScroll:!0,onSuccess:()=>{k.add({severity:"success",summary:"Voided",detail:"Order has been voided",life:2200}),I.value=!1,C.value=null},onError:()=>{k.add({severity:"error",summary:"Failed",detail:"Could not void order",life:2500})},onFinish:()=>Y.value=!1}))}const O=c(!1),U=c(null),H=c(!1),D=c([$()]);function Ae(s){return(s==null?void 0:s.status)==="draft"}function Me(s){U.value=s,O.value=!0,D.value=[$()]}const J=x(()=>{var s;return Number(((s=U.value)==null?void 0:s.total_amount)||0)}),ue=x(()=>D.value.reduce((s,e)=>s+Number(e.amount||0),0)),Q=x(()=>Math.max(0,J.value-ue.value)),X=x(()=>Math.max(0,ue.value-J.value));function Ie(s){if(!s)return null;const e={customer_bank_name:s.customer_bank_name||null,customer_account_no:s.customer_account_no||null,received_to_bank_account_id:s.received_to_bank_account_id||null,txn_ref:s.txn_ref||null};return Object.values(e).some(m=>m!==null)?e:null}function re(s){const e=s.value.filter(m=>m.payment_method_id&&Number(m.amount||0)>0);if(!e.length)return k.add({severity:"warn",summary:"Payment required",detail:"Add at least one payment",life:2200}),null;for(const m of e)if(K(m)){const l=m.meta||{};if(!l.customer_bank_name||!l.customer_account_no)return k.add({severity:"warn",summary:"Bank info required",detail:"Customer bank name & account no are required for bank payments",life:2500}),null}return e.map(m=>{var l,u;return{payment_method_id:m.payment_method_id,amount:Number(m.amount),transaction_ref:((l=m.transaction_ref)==null?void 0:l.trim())||null,notes:((u=m.notes)==null?void 0:u.trim())||null,meta:Ie(m.meta)}})}function Oe(){if(!U.value)return;const s=re(D);s&&(H.value=!0,T.post(route("pos.orders.complete",U.value.id),{payments:s},{preserveScroll:!0,onSuccess:()=>{k.add({severity:"success",summary:"Completed",detail:"Draft order completed",life:2200}),O.value=!1,U.value=null},onError:()=>{k.add({severity:"error",summary:"Failed",detail:"Could not complete draft",life:2500})},onFinish:()=>H.value=!1}))}const B=c(!1),w=c(null),Z=c(!1),P=c([$()]);function Be(s){return s&&s.status!=="void"&&s.status!=="draft"&&(s.payment_status==="partial"||s.payment_status==="unpaid")}function je(s){w.value=s,B.value=!0,P.value=[$()]}const me=x(()=>{var s;return Number(((s=w.value)==null?void 0:s.total_amount)||0)}),pe=x(()=>{var s;return Number(((s=w.value)==null?void 0:s.paid_amount)||0)}),ee=x(()=>Math.max(0,me.value-pe.value)),ce=x(()=>P.value.reduce((s,e)=>s+Number(e.amount||0),0)),Le=x(()=>Math.max(0,ee.value-ce.value)),ve=x(()=>Math.max(0,ce.value-ee.value));function Re(){if(!w.value)return;const s=re(P);s&&(Z.value=!0,T.post(route("pos.orders.payments.store",w.value.id),{payments:s},{preserveScroll:!0,onSuccess:()=>{k.add({severity:"success",summary:"Payment added",detail:"Due updated successfully",life:2200}),B.value=!1,w.value=null},onError:()=>{k.add({severity:"error",summary:"Failed",detail:"Could not add payment",life:2500})},onFinish:()=>Z.value=!1}))}return(s,e)=>{const h=Ge,m=qe;return r(),F(ze,null,{default:v(()=>[t("div",Ye,[t("div",He,[e[18]||(e[18]=t("div",null,[t("h2",{class:"text-xl font-semibold flex items-center gap-2"},[t("i",{class:"pi pi-receipt text-primary"}),p(" POS Sales ")]),t("p",{class:"text-sm text-gray-500"}," View and manage Point of Sale orders ")],-1)),t("div",Je," Page Total: "+d(Se.value.toFixed(2)),1)]),t("div",Qe,[o(m,{class:"max-w-sm"},{default:v(()=>[o(h,null,{default:v(()=>e[19]||(e[19]=[t("i",{class:"pi pi-search"},null,-1)])),_:1}),o(a(_),{modelValue:j.value,"onUpdate:modelValue":e[0]||(e[0]=l=>j.value=l),placeholder:"Invoice / customer / cashier",class:"w-full",onKeyup:We(le,["enter"])},null,8,["modelValue"])]),_:1}),o(a(E),{modelValue:L.value,"onUpdate:modelValue":e[1]||(e[1]=l=>L.value=l),options:we,optionLabel:"label",optionValue:"value",placeholder:"Order Status",class:"w-full md:w-44"},null,8,["modelValue"]),o(a(E),{modelValue:R.value,"onUpdate:modelValue":e[2]||(e[2]=l=>R.value=l),options:he,optionLabel:"label",optionValue:"value",placeholder:"Payment Status",class:"w-full md:w-44"},null,8,["modelValue"]),o(a(ke),{modelValue:N.value,"onUpdate:modelValue":e[3]||(e[3]=l=>N.value=l),placeholder:"From",dateFormat:"yy-mm-dd",showIcon:"",class:"w-full md:w-44"},null,8,["modelValue"]),o(a(ke),{modelValue:A.value,"onUpdate:modelValue":e[4]||(e[4]=l=>A.value=l),placeholder:"To",dateFormat:"yy-mm-dd",showIcon:"",class:"w-full md:w-44"},null,8,["modelValue"]),o(a(i),{label:"Apply",icon:"pi pi-filter",class:"p-button-outlined",onClick:le}),o(a(i),{label:"Reset",icon:"pi pi-refresh",class:"p-button-text",onClick:Ue})]),t("div",Xe,[o(a(Ke),{value:ae.value,responsiveLayout:"scroll",size:"small",showGridlines:""},{default:v(()=>[o(a(S),{header:"Invoice"},{body:v(({data:l})=>[t("div",Ze,[t("span",et,d(M(l)),1),t("span",tt,d(new Date(l.created_at).toLocaleString()),1)])]),_:1}),o(a(S),{header:"Customer"},{body:v(({data:l})=>{var u;return[p(d(((u=l.customer)==null?void 0:u.name)||"Walk-in"),1)]}),_:1}),o(a(S),{header:"Cashier"},{body:v(({data:l})=>{var u;return[p(d(((u=l.user)==null?void 0:u.name)||"-"),1)]}),_:1}),o(a(S),{header:"Total"},{body:v(({data:l})=>[t("span",lt,d(Number(l.total_amount||0).toFixed(2)),1)]),_:1}),o(a(S),{header:"Payment"},{body:v(({data:l})=>[o(a(Ce),{value:l.payment_status,severity:$e(l.payment_status)},null,8,["value","severity"])]),_:1}),o(a(S),{header:"Status"},{body:v(({data:l})=>[o(a(Ce),{value:l.status,severity:De(l.status)},null,8,["value","severity"])]),_:1}),o(a(S),{header:"Actions"},{body:v(({data:l})=>[t("div",st,[o(a(i),{icon:"pi pi-eye",class:"p-button-text p-button-sm",onClick:u=>Pe(l)},null,8,["onClick"]),o(a(i),{icon:"pi pi-external-link",class:"p-button-text p-button-sm",onClick:u=>oe(l)},null,8,["onClick"]),l.status!=="void"?(r(),F(a(i),{key:0,icon:"pi pi-print",class:"p-button-text p-button-sm",onClick:u=>ne(l)},null,8,["onClick"])):f("",!0),Be(l)?(r(),F(a(i),{key:1,icon:"pi pi-wallet",class:"p-button-text p-button-sm p-button-warning",onClick:u=>je(l)},null,8,["onClick"])):f("",!0),Ae(l)?(r(),F(a(i),{key:2,icon:"pi pi-check",class:"p-button-text p-button-sm p-button-success",onClick:u=>Me(l)},null,8,["onClick"])):f("",!0),Fe(l)?(r(),F(a(i),{key:3,icon:"pi pi-ban",class:"p-button-text p-button-sm p-button-danger",onClick:u=>Te(l)},null,8,["onClick"])):f("",!0)])]),_:1})]),_:1},8,["value"]),t("div",at,[t("span",null,"Showing "+d(g.orders.from)+"–"+d(g.orders.to)+" of "+d(g.orders.total),1),t("div",ot,[o(a(i),{icon:"pi pi-angle-left",class:"p-button-text",disabled:!g.orders.prev_page_url,onClick:e[5]||(e[5]=l=>se(g.orders.prev_page_url))},null,8,["disabled"]),o(a(i),{icon:"pi pi-angle-right",class:"p-button-text",disabled:!g.orders.next_page_url,onClick:e[6]||(e[6]=l=>se(g.orders.next_page_url))},null,8,["disabled"])])])])]),o(a(q),{visible:z.value,"onUpdate:visible":e[9]||(e[9]=l=>z.value=l),modal:"",header:"Invoice Preview",style:{width:"760px"}},{default:v(()=>{var l;return[y.value?(r(),b("div",nt,[t("div",dt,[t("div",null,[e[20]||(e[20]=t("div",{class:"text-sm text-gray-500"},"Invoice",-1)),t("div",it,d(M(y.value)),1),t("div",ut,d(new Date(y.value.created_at).toLocaleString()),1)]),t("div",rt,[o(a(i),{label:"Open",icon:"pi pi-external-link",severity:"secondary",onClick:e[7]||(e[7]=u=>oe(y.value))}),y.value.status!=="void"?(r(),F(a(i),{key:0,label:"Print",icon:"pi pi-print",class:"p-button-success",onClick:e[8]||(e[8]=u=>ne(y.value))})):f("",!0)])]),t("div",mt,[t("div",pt,[e[21]||(e[21]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Customer ",-1)),t("div",ct,d(((l=y.value.customer)==null?void 0:l.name)||"Walk-in"),1)]),t("div",vt,[e[22]||(e[22]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Summary ",-1)),t("div",null," Total: "+d(Number(y.value.total_amount||0).toFixed(2)),1),t("div",ft," Payment: "+d(y.value.payment_status),1),t("div",bt," Status: "+d(y.value.status),1)])])])):f("",!0)]}),_:1},8,["visible"]),o(a(q),{visible:I.value,"onUpdate:visible":e[11]||(e[11]=l=>I.value=l),modal:"",header:"Void Order",style:{width:"520px"}},{default:v(()=>[C.value?(r(),b("div",xt,[e[26]||(e[26]=t("div",{class:"p-3 rounded-xl border bg-red-50 border-red-200 text-red-800 text-sm"},[t("div",{class:"font-bold"},"This will void the order."),t("div",{class:"text-xs mt-1"},[p(" If order is "),t("b",null,"completed"),p(", stock will be restored (your backend logic). ")])],-1)),t("div",yt,[t("div",null,[e[23]||(e[23]=t("b",null,"Invoice:",-1)),p(" "+d(M(C.value)),1)]),t("div",null,[e[24]||(e[24]=t("b",null,"Total:",-1)),p(" "+d(Number(C.value.total_amount||0).toFixed(2)),1)]),t("div",null,[e[25]||(e[25]=t("b",null,"Status:",-1)),p(" "+d(C.value.status),1)])]),t("div",_t,[o(a(i),{label:"Cancel",class:"p-button-text",onClick:e[10]||(e[10]=l=>I.value=!1)}),o(a(i),{label:"Void Now",icon:"pi pi-ban",class:"p-button-danger",loading:Y.value,onClick:Ne},null,8,["loading"])])])):f("",!0)]),_:1},8,["visible"]),o(a(q),{visible:O.value,"onUpdate:visible":e[14]||(e[14]=l=>O.value=l),modal:"",header:"Complete Draft",style:{width:"760px"}},{default:v(()=>[U.value?(r(),b("div",gt,[e[40]||(e[40]=t("div",{class:"p-3 rounded-xl border bg-emerald-50 border-emerald-200 text-emerald-800 text-sm"},[t("div",{class:"font-bold"},"Complete this draft order?"),t("div",{class:"text-xs mt-1"}," Add payments and bank info (if bank method). ")],-1)),t("div",Vt,[t("div",kt,[e[27]||(e[27]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Invoice ",-1)),t("div",Ct,d(M(U.value)),1)]),t("div",wt,[e[28]||(e[28]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Total ",-1)),t("div",ht,d(J.value.toFixed(2)),1)]),t("div",Ut,[e[29]||(e[29]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Due / Change ",-1)),Q.value>0?(r(),b("div",St," Due: "+d(Q.value.toFixed(2)),1)):f("",!0),X.value>0?(r(),b("div",$t," Change: "+d(X.value.toFixed(2)),1)):f("",!0),Q.value===0&&X.value===0?(r(),b("div",Dt," Balanced ")):f("",!0)])]),o(a(G)),t("div",Pt,[e[30]||(e[30]=t("div",{class:"font-semibold"},"Payments",-1)),o(a(i),{label:"Add payment",icon:"pi pi-plus",class:"p-button-text",onClick:e[12]||(e[12]=l=>de(D.value))})]),t("div",Ft,[(r(!0),b(ge,null,Ve(D.value,(l,u)=>(r(),b("div",{key:l.id,class:"border rounded-xl p-3 bg-white"},[t("div",Tt,[t("div",null,[e[31]||(e[31]=t("div",{class:"text-xs text-slate-500 mb-1"},[p(" Method "),t("span",{class:"text-red-600"},"*")],-1)),o(a(E),{modelValue:l.payment_method_id,"onUpdate:modelValue":n=>l.payment_method_id=n,options:g.paymentMethods,optionLabel:"name",optionValue:"id",placeholder:"Select method",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options"])]),t("div",null,[e[32]||(e[32]=t("div",{class:"text-xs text-slate-500 mb-1"},[p(" Amount "),t("span",{class:"text-red-600"},"*")],-1)),o(a(W),{modelValue:l.amount,"onUpdate:modelValue":n=>l.amount=n,min:0,class:"w-full",inputClass:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",Nt,[o(a(i),{icon:"pi pi-trash",class:"p-button-text p-button-danger",onClick:n=>ie(D.value,u)},null,8,["onClick"])])]),t("div",At,[t("div",null,[e[33]||(e[33]=t("div",{class:"text-xs text-slate-500 mb-1"}," Txn Ref ",-1)),o(a(_),{modelValue:l.transaction_ref,"onUpdate:modelValue":n=>l.transaction_ref=n,class:"w-full",placeholder:"Gateway / Slip ref (optional)"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[34]||(e[34]=t("div",{class:"text-xs text-slate-500 mb-1"}," Notes ",-1)),o(a(_),{modelValue:l.notes,"onUpdate:modelValue":n=>l.notes=n,class:"w-full",placeholder:"Optional note"},null,8,["modelValue","onUpdate:modelValue"])])]),l.payment_method_id&&K(l)?(r(),b("div",Mt,[e[39]||(e[39]=t("div",{class:"font-semibold text-sm mb-2"}," Bank Info (Required for bank) ",-1)),t("div",It,[t("div",null,[e[35]||(e[35]=t("div",{class:"text-xs text-slate-500 mb-1"},[p(" Customer Bank Name "),t("span",{class:"text-red-600"},"*")],-1)),o(a(_),{modelValue:l.meta.customer_bank_name,"onUpdate:modelValue":n=>l.meta.customer_bank_name=n,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[36]||(e[36]=t("div",{class:"text-xs text-slate-500 mb-1"},[p(" Customer Account No "),t("span",{class:"text-red-600"},"*")],-1)),o(a(_),{modelValue:l.meta.customer_account_no,"onUpdate:modelValue":n=>l.meta.customer_account_no=n,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[37]||(e[37]=t("div",{class:"text-xs text-slate-500 mb-1"}," Received To Bank Account ID ",-1)),o(a(W),{modelValue:l.meta.received_to_bank_account_id,"onUpdate:modelValue":n=>l.meta.received_to_bank_account_id=n,class:"w-full",inputClass:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[38]||(e[38]=t("div",{class:"text-xs text-slate-500 mb-1"}," Bank Txn / Cheque No ",-1)),o(a(_),{modelValue:l.meta.txn_ref,"onUpdate:modelValue":n=>l.meta.txn_ref=n,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])])])):f("",!0)]))),128))]),o(a(G)),t("div",Ot,[o(a(i),{label:"Cancel",class:"p-button-text",onClick:e[13]||(e[13]=l=>O.value=!1)}),o(a(i),{label:"Complete Draft",icon:"pi pi-check",class:"p-button-success",loading:H.value,onClick:Oe},null,8,["loading"])])])):f("",!0)]),_:1},8,["visible"]),o(a(q),{visible:B.value,"onUpdate:visible":e[17]||(e[17]=l=>B.value=l),modal:"",header:"Pay Due",style:{width:"760px"}},{default:v(()=>[w.value?(r(),b("div",Bt,[t("div",jt,[e[44]||(e[44]=t("div",{class:"font-bold"},"Add payment for this sale",-1)),t("div",Lt,[e[42]||(e[42]=p(" Current Due: ")),t("b",null,d(ee.value.toFixed(2)),1),e[43]||(e[43]=p(" • After Pay: ")),t("b",null,d(Le.value.toFixed(2)),1),ve.value>0?(r(),b("span",Rt,[e[41]||(e[41]=p(" • Change: ")),t("b",null,d(ve.value.toFixed(2)),1)])):f("",!0)])]),t("div",qt,[t("div",Gt,[e[45]||(e[45]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Invoice ",-1)),t("div",Et,d(M(w.value)),1)]),t("div",Wt,[e[46]||(e[46]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Total ",-1)),t("div",zt,d(me.value.toFixed(2)),1)]),t("div",Kt,[e[47]||(e[47]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Already Paid ",-1)),t("div",Yt,d(pe.value.toFixed(2)),1)])]),o(a(G)),t("div",Ht,[e[48]||(e[48]=t("div",{class:"font-semibold"},"Payments",-1)),o(a(i),{label:"Add payment",icon:"pi pi-plus",class:"p-button-text",onClick:e[15]||(e[15]=l=>de(P.value))})]),t("div",Jt,[(r(!0),b(ge,null,Ve(P.value,(l,u)=>(r(),b("div",{key:l.id,class:"border rounded-xl p-3 bg-white"},[t("div",Qt,[t("div",null,[e[49]||(e[49]=t("div",{class:"text-xs text-slate-500 mb-1"},[p(" Method "),t("span",{class:"text-red-600"},"*")],-1)),o(a(E),{modelValue:l.payment_method_id,"onUpdate:modelValue":n=>l.payment_method_id=n,options:g.paymentMethods,optionLabel:"name",optionValue:"id",placeholder:"Select method",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options"])]),t("div",null,[e[50]||(e[50]=t("div",{class:"text-xs text-slate-500 mb-1"},[p(" Amount "),t("span",{class:"text-red-600"},"*")],-1)),o(a(W),{modelValue:l.amount,"onUpdate:modelValue":n=>l.amount=n,min:0,class:"w-full",inputClass:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",Xt,[o(a(i),{icon:"pi pi-trash",class:"p-button-text p-button-danger",onClick:n=>ie(P.value,u)},null,8,["onClick"])])]),t("div",Zt,[t("div",null,[e[51]||(e[51]=t("div",{class:"text-xs text-slate-500 mb-1"}," Txn Ref ",-1)),o(a(_),{modelValue:l.transaction_ref,"onUpdate:modelValue":n=>l.transaction_ref=n,class:"w-full",placeholder:"Gateway / Slip ref (optional)"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[52]||(e[52]=t("div",{class:"text-xs text-slate-500 mb-1"}," Notes ",-1)),o(a(_),{modelValue:l.notes,"onUpdate:modelValue":n=>l.notes=n,class:"w-full",placeholder:"Optional note"},null,8,["modelValue","onUpdate:modelValue"])])]),l.payment_method_id&&K(l)?(r(),b("div",el,[e[57]||(e[57]=t("div",{class:"font-semibold text-sm mb-2"}," Bank Info (Required for bank) ",-1)),t("div",tl,[t("div",null,[e[53]||(e[53]=t("div",{class:"text-xs text-slate-500 mb-1"},[p(" Customer Bank Name "),t("span",{class:"text-red-600"},"*")],-1)),o(a(_),{modelValue:l.meta.customer_bank_name,"onUpdate:modelValue":n=>l.meta.customer_bank_name=n,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[54]||(e[54]=t("div",{class:"text-xs text-slate-500 mb-1"},[p(" Customer Account No "),t("span",{class:"text-red-600"},"*")],-1)),o(a(_),{modelValue:l.meta.customer_account_no,"onUpdate:modelValue":n=>l.meta.customer_account_no=n,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[55]||(e[55]=t("div",{class:"text-xs text-slate-500 mb-1"}," Received To Bank Account ID ",-1)),o(a(W),{modelValue:l.meta.received_to_bank_account_id,"onUpdate:modelValue":n=>l.meta.received_to_bank_account_id=n,class:"w-full",inputClass:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[56]||(e[56]=t("div",{class:"text-xs text-slate-500 mb-1"}," Bank Txn / Cheque No ",-1)),o(a(_),{modelValue:l.meta.txn_ref,"onUpdate:modelValue":n=>l.meta.txn_ref=n,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])])])):f("",!0)]))),128))]),o(a(G)),t("div",ll,[o(a(i),{label:"Cancel",class:"p-button-text",onClick:e[16]||(e[16]=l=>B.value=!1)}),o(a(i),{label:"Submit Payment",icon:"pi pi-check",class:"p-button-warning",loading:Z.value,onClick:Re},null,8,["loading"])])])):f("",!0)]),_:1},8,["visible"])]),_:1})}}};export{Fl as default};
