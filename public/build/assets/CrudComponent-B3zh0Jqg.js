import{s as de}from"./index-WAZDV9qK.js";import{a as ce,s as pe}from"./index-Czi3W0yq.js";import{b as me,c as ve}from"./index-BZdu1q0f.js";import{s as fe}from"./index-BGTr00vW.js";import{d as ge,s as be}from"./debounce-C-0LUHuC.js";import{s as ye}from"./index-BV1P04VT.js";import{B as he,c as ke,o as d,J as E,m as xe,W as b,f as U,n as Re,O as we,r as v,ay as Se,g as Ce,I as c,w as n,b as u,a as r,d as m,N as A,u as w,P as G,j as W,ai as O,t as _,K as De,ag as Ie,ah as Pe}from"./app-CfZqGFrz.js";import{a as $e}from"./index-BP4g10d4.js";import{_ as Ee}from"./AuthenticatedLayout-DJHnQnZa.js";import{r as Be}from"./imageHelper-BscTlunE.js";var Ne=function(k){return k.dt,`
.p-buttongroup {
    display: inline-flex;
}

.p-buttongroup .p-button {
    margin: 0;
}

.p-buttongroup .p-button:not(:last-child),
.p-buttongroup .p-button:not(:last-child):hover {
    border-inline-end: 0 none;
}

.p-buttongroup .p-button:not(:first-of-type):not(:last-of-type) {
    border-radius: 0;
}

.p-buttongroup .p-button:first-of-type:not(:only-of-type) {
    border-start-end-radius: 0;
    border-end-end-radius: 0;
}

.p-buttongroup .p-button:last-of-type:not(:only-of-type) {
    border-start-start-radius: 0;
    border-end-start-radius: 0;
}

.p-buttongroup .p-button:focus {
    position: relative;
    z-index: 1;
}
`},Te={root:"p-buttongroup p-component"},Ue=he.extend({name:"buttongroup",theme:Ne,classes:Te}),Ae={name:"BaseButtonGroup",extends:ye,style:Ue,provide:function(){return{$pcButtonGroup:this,$parentInstance:this}}},Y={name:"ButtonGroup",extends:Ae,inheritAttrs:!1};function Oe(a,k,B,P,j,l){return d(),ke("span",xe({class:a.cx("root"),role:"group"},a.ptmi("root")),[E(a.$slots,"default")],16)}Y.render=Oe;const je=(a,k,B)=>{const P=a.first/a.rows+1;b.get(k,{page:P,per_page:a.rows},{preserveState:!0,preserveScroll:!0,only:["items"]})},ze=[{label:"Active",value:1},{label:"Inactive",value:0}],Le={class:"card"},Ve={class:"flex flex-wrap gap-2"},Fe={class:"p-4 text-center"},Me={class:"text-lg"},Ge={class:"flex flex-wrap gap-2 items-center justify-between"},We={class:"text-3xl"},_e={class:"mt-3"},lt={__name:"CrudComponent",props:["form","formWidth","canEdit","canDelete"],emits:["editingItem"],setup(a,{emit:k}){const B=U(()=>a.canDelete===!1),P=U(()=>a.canEdit===!1),j=Re(),l=U(()=>j.props),p=we(),z=v(),S=v(!1),x=v(!1),C=v(!1),D=v(!1),i=v(),R=v({global:{value:null,matchMode:Se.CONTAINS}}),y=v(null),K=o=>{const e=o.files[0];a.form.photo=e;const t=new FileReader;t.onload=async g=>{y.value=g.target.result},t.readAsDataURL(e)},J=()=>{I.value=!1,a.form.reset(),x.value=!1,S.value=!0,y.value=null},N=()=>{S.value=!1,x.value=!1},L=(o=!1)=>{x.value=!0,a.form.ids&&(a.form.ids=a.form.ids.map(e=>e.id)),a.form.post(l.value.config.storeRoute,{onSuccess:()=>{if(a.form.reset(),y.value=null,p.add({severity:"success",summary:"Successful",detail:"Successfully Created!",life:3e3}),o){x.value=!1;return}else N()},onError:e=>{Object.entries(e).forEach((t,g)=>{p.add({severity:"error",summary:"Validation Error",detail:t[1],life:3e3})})}})},I=v(!1),$=v(null),q=()=>{x.value=!0;const o=l.value.config.updateRoute.replace("__ID__",$.value);a.form.ids&&(a.form.ids=a.form.ids.map(t=>t.id));const e={_method:"put",...a.form};b.post(o,e,{onSuccess:()=>{N(),y.value=null,a.form.reset(),p.add({severity:"success",summary:"Successful",detail:"Successfully Updated!",life:3e3})},onError:t=>{Object.entries(t).forEach((g,V)=>{p.add({severity:"error",summary:"Validation Error",detail:g[1],life:3e3})})}})},H=k,Q=o=>{H("editingItem",o),S.value=!0,I.value=!0,y.value=null,Object.assign(a.form,o),$.value=o.id},X=o=>{C.value=!0,y.value=null,Object.assign(a.form,o),$.value=o.id},Z=()=>{const o=i.value.map(e=>e.id);i.value=null,b.post(l.value.config.bulkRestoreRoute,{ids:o},{onSuccess:()=>{f.value=!1,b.get(l.value.config.indexRoute),p.add({severity:"success",summary:"Restored",detail:"Selected Items Restored!",life:3e3})},onError:e=>{Object.entries(e).forEach((t,g)=>{p.add({severity:"error",summary:"Restore Error",detail:t[1],life:3e3})})}})},ee=()=>{const o=i.value.map(e=>e.id);i.value=null,b.post(l.value.config.bulkForceDeleteRoute,{ids:o},{onSuccess:()=>{f.value=!1,b.get(l.value.config.indexRoute),p.add({severity:"warn",summary:"Permanently Delete",detail:"Items Permanently Deleted!",life:3e3})},onError:e=>{Object.entries(e).forEach((t,g)=>{p.add({severity:"error",summary:"Permanent Delete Error",detail:t[1],life:3e3})})}})},te=()=>{C.value=!1;const o=l.value.config.deleteRoute.replace("__ID__",$.value);b.delete(o,{onSuccess:()=>{p.add({severity:"error",summary:"Deleted",detail:"Successfully Deleted",life:3e3})}})},le=()=>{const o=new URLSearchParams({search:R.value.global.value||""}).toString(),e=document.createElement("a");e.href=`${l.value.config.exportRoute}?${o}`,e.setAttribute("download",""),document.body.appendChild(e),e.click(),document.body.removeChild(e),p.add({severity:"success",summary:"Export Started",detail:"Your export will download shortly.",life:3e3})},oe=()=>{D.value=!0},ae=()=>{const o=i.value.map(e=>e.id);D.value=!1,i.value=null,b.post(l.value.config.bulkDeleteRoute,{ids:o},{onSuccess:()=>{p.add({severity:"error",summary:"Deleted",detail:"Selected Items Deleted",life:3e3})},onError:e=>{Object.entries(e).forEach((t,g)=>{p.add({severity:"error",summary:"Delete Error",detail:t[1],life:3e3})})}})},se=ge(o=>{var e;R.value.global.value=o.target.value,b.get(l.value.config.indexRoute,{search:o.target.value,per_page:(e=z.value)==null?void 0:e.rows},{preserveState:!0,preserveScroll:!0,only:["items"]})},300);Ce(()=>{l.value.filters.search&&(R.value.global.value=l.value.filters.search)});const f=v(route().params.trashed==="1");return(o,e)=>{const t=$e,g=Y,V=be,ne=ve,re=fe,ie=me,F=pe,ue=ce,T=de;return d(),c(Ee,null,{default:n(()=>[u("div",Le,[r(V,{class:""},{start:n(()=>{var s,h,M;return[u("div",Ve,[r(t,{label:"Create New",icon:"pi pi-plus",onClick:J,outlined:"",severity:"primary"}),r(g,null,{default:n(()=>[l.value.config.indexRoute?(d(),c(w(G),{key:0,href:l.value.config.indexRoute},{default:n(()=>[r(t,{label:"All Items",icon:"pi pi-list",class:W({"border-bottom-2":!f.value}),text:""},null,8,["class"])]),_:1},8,["href"])):m("",!0),l.value.config.bulkRestoreRoute?(d(),c(w(G),{key:1,href:l.value.config.indexRouteTrashed},{default:n(()=>[r(t,{label:"Trashed",icon:"pi pi-ban",class:W({"border-bottom-2":f.value}),text:""},null,8,["class"])]),_:1},8,["href"])):m("",!0)]),_:1}),l.value.config.bulkRestoreRoute?A((d(),c(t,{key:0,label:"Bulk Delete",icon:"pi pi-trash",severity:"danger",outlined:"",onClick:oe},null,512)),[[O,!(!i.value||!((s=i.value)!=null&&s.length))&&!f.value]]):m("",!0),l.value.config.bulkRestoreRoute?A((d(),c(t,{key:1,label:"Bulk Restore",icon:"pi pi-undo",severity:"warn",outlined:"",onClick:Z},null,512)),[[O,!(!i.value||!((h=i.value)!=null&&h.length))&&f.value]]):m("",!0),l.value.config.bulkRestoreRoute?A((d(),c(t,{key:2,label:"Force Delete",icon:"pi pi-trash",severity:"danger",outlined:"",onClick:ee},null,512)),[[O,!(!i.value||!((M=i.value)!=null&&M.length))&&f.value]]):m("",!0)])]}),center:n(()=>[E(o.$slots,"messages")]),end:n(()=>{var s,h;return[(h=(s=l.value)==null?void 0:s.config)!=null&&h.exportRoute?(d(),c(t,{key:0,label:"Export",class:"mx-2",icon:"pi pi-upload",severity:"secondary",onClick:le})):m("",!0)]}),_:3}),r(ue,{ref_key:"dt",ref:z,selection:i.value,"onUpdate:selection":e[1]||(e[1]=s=>i.value=s),value:l.value.items.data,dataKey:"id",paginator:!0,rows:15,filters:R.value,totalRecords:l.value.items.total,lazy:!0,onPage:e[2]||(e[2]=s=>w(je)(s,l.value.config.indexRoute,l.value.config.resource)),paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:`Showing {first} to {last} of {totalRecords} ${l.value.config.resource}`,resizableColumns:"",columnResizeMode:"fit"},{empty:n(()=>[u("div",Fe,[u("p",Me,"No "+_(l.value.config.resource)+" found.",1)])]),header:n(()=>[u("div",Ge,[u("h1",We,_(l.value.config.title),1),r(ie,null,{default:n(()=>[r(ne,null,{default:n(()=>e[10]||(e[10]=[u("i",{class:"pi pi-search"},null,-1)])),_:1}),r(re,{modelValue:R.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=s=>R.value.global.value=s),type:"search",onInput:w(se),placeholder:"Search...",clearable:""},null,8,["modelValue","onInput"])]),_:1})])]),default:n(()=>[l.value.config.bulkRestoreRoute?(d(),c(F,{key:0,selectionMode:"multiple",style:{width:"3rem"},exportable:!1,header:""})):m("",!0),E(o.$slots,"columns"),r(F,{exportable:!1,style:{"min-width":"12rem"}},{body:n(s=>[P.value?m("",!0):(d(),c(t,{key:0,icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:h=>Q(s.data),disabled:f.value},null,8,["onClick","disabled"])),B.value?m("",!0):(d(),c(t,{key:1,icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:h=>X(s.data),disabled:f.value},null,8,["onClick","disabled"]))]),_:1})]),_:3},8,["selection","value","filters","totalRecords","currentPageReportTemplate"])]),r(T,{visible:S.value,"onUpdate:visible":e[5]||(e[5]=s=>S.value=s),maximizable:"",style:De({width:a.formWidth??"60vw"}),breakpoints:{"960px":"75vw","640px":"95vw"},header:`${l.value.config.modelRaw} Details`,"pt:mask:class":"backdrop-blur-sm"},{footer:n(()=>[u("div",_e,[r(t,{label:"Cancel",icon:"pi pi-times",text:"",onClick:N}),I.value?m("",!0):(d(),c(t,{key:0,label:"Save & Continue",text:"",icon:"pi pi-check",onClick:e[3]||(e[3]=s=>L(!0))})),I.value?m("",!0):(d(),c(t,{key:1,label:"Save",icon:"pi pi-check",onClick:e[4]||(e[4]=s=>L(!1))})),I.value?(d(),c(t,{key:2,label:"Update",icon:"pi pi-check",onClick:q})):m("",!0)])]),default:n(()=>[E(o.$slots,"form",Ie(Pe({submitted:x.value,statuses:w(ze),handlePhotoUpload:K,photoPreview:y.value,resolveImagePath:w(Be)})))]),_:3},8,["visible","style","header"]),r(T,{visible:C.value,"onUpdate:visible":e[7]||(e[7]=s=>C.value=s),style:{width:"450px"},header:"Confirm Delete"},{footer:n(()=>[r(t,{label:"No",icon:"pi pi-times",text:"",onClick:e[6]||(e[6]=s=>C.value=!1)}),r(t,{label:"Yes",icon:"pi pi-check",onClick:te})]),default:n(()=>[e[11]||(e[11]=u("div",{class:"flex items-center gap-4"},[u("i",{class:"pi pi-exclamation-triangle !text-3xl"}),u("span",null,"Are you sure you want to delete?")],-1))]),_:1},8,["visible"]),r(T,{visible:D.value,"onUpdate:visible":e[9]||(e[9]=s=>D.value=s),style:{width:"450px"},header:"Confirm Delete"},{footer:n(()=>[r(t,{label:"No",icon:"pi pi-times",text:"",onClick:e[8]||(e[8]=s=>D.value=!1)}),r(t,{label:"Yes",icon:"pi pi-check",text:"",onClick:ae})]),default:n(()=>[e[12]||(e[12]=u("div",{class:"flex items-center gap-4"},[u("i",{class:"pi pi-exclamation-triangle !text-3xl"}),u("span",null,"Are you sure you want to delete the selected items?")],-1))]),_:1},8,["visible"])]),_:3})}}};export{lt as _};
