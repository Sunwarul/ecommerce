import{s as ze,a as Ke}from"./index-vSdeYZTi.js";import{O as He,r as f,f as g,I as P,o as p,w as y,b as t,a,e as v,t as i,u as o,S as Ye,d as x,c as _,F as Ve,i as Ce,W as T}from"./app-B-_qiM2O.js";import{_ as Je}from"./AuthenticatedLayout-BqfRNi2u.js";import{a as r}from"./index-ClBApoCN.js";import{s as we}from"./index-CSslStHd.js";import{a as Qe,s as F}from"./index-CEtRtcbg.js";import{s as E}from"./index-ZJEFmuJ0.js";import{s as he,a as G}from"./index-CVFNqisN.js";import{s as W}from"./index-abn9Y2KC.js";import{s as z}from"./index-po1iam4k.js";import{s as w}from"./index-CFOhnWAd.js";import"./index-DwjWSNm_.js";import"./index-B8KsdCOI.js";import"./index-BVP9GjF8.js";import"./index-TosEN7lK.js";import"./index-DLIcxrJX.js";import"./index-ixHmoZJY.js";import"./index-Dx3mN99j.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./FavIcons-B-UgDdlO.js";import"./index-BWH0DLnf.js";import"./index-CDJH0Ngp.js";import"./index-CB8TntoD.js";import"./index-Ch4YBmFi.js";import"./index-B-4sJkkQ.js";import"./index-C35peN7s.js";import"./index-CdN0EvkT.js";import"./index-CNQJp16r.js";const b=[];for(let n=0;n<256;++n)b.push((n+256).toString(16).slice(1));function Xe(n,u=0){return(b[n[u+0]]+b[n[u+1]]+b[n[u+2]]+b[n[u+3]]+"-"+b[n[u+4]]+b[n[u+5]]+"-"+b[n[u+6]]+b[n[u+7]]+"-"+b[n[u+8]]+b[n[u+9]]+"-"+b[n[u+10]]+b[n[u+11]]+b[n[u+12]]+b[n[u+13]]+b[n[u+14]]+b[n[u+15]]).toLowerCase()}let le;const Ze=new Uint8Array(16);function et(){if(!le){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");le=crypto.getRandomValues.bind(crypto)}return le(Ze)}const tt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ue={randomUUID:tt};function lt(n,u,k){var D;n=n||{};const V=n.random??((D=n.rng)==null?void 0:D.call(n))??et();if(V.length<16)throw new Error("Random bytes length must be >= 16");return V[6]=V[6]&15|64,V[8]=V[8]&63|128,Xe(V)}function st(n,u,k){return Ue.randomUUID?Ue.randomUUID():lt(n)}const ot={class:"p-4 md:p-6 space-y-4"},at={class:"flex justify-between flex-wrap gap-3"},nt={class:"px-4 py-2 rounded-xl bg-emerald-50 text-emerald-700 text-sm font-semibold"},dt={class:"card p-3 flex flex-wrap gap-3 items-center"},it={class:"card"},ut={class:"flex flex-col"},rt={class:"font-semibold text-slate-800"},mt={class:"text-xs text-slate-500"},pt={class:"font-semibold text-emerald-600"},ct={class:"flex gap-1 flex-wrap"},vt={class:"flex justify-between items-center mt-3 text-sm text-gray-500"},ft={class:"flex gap-1"},bt={key:0,class:"space-y-3"},xt={class:"flex justify-between gap-3 flex-wrap"},yt={class:"text-xl font-bold"},_t={class:"text-xs text-gray-500"},gt={class:"flex gap-2"},kt={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Vt={class:"p-3 border rounded-lg"},Ct={class:"font-medium"},wt={class:"p-3 border rounded-lg"},ht={class:"capitalize"},Ut={class:"capitalize"},St={key:0,class:"space-y-3"},Dt={class:"text-sm"},$t={class:"flex justify-end gap-2"},Pt={key:0,class:"space-y-4"},Tt={class:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm"},Ft={class:"p-3 border rounded-lg"},It={class:"font-semibold"},At={class:"p-3 border rounded-lg"},Nt={class:"font-semibold"},Mt={class:"p-3 border rounded-lg"},Ot={key:0,class:"font-semibold text-rose-600"},Rt={key:1,class:"font-semibold text-emerald-600"},Bt={key:2,class:"font-semibold text-slate-700"},jt={class:"flex items-center justify-between"},Lt={class:"space-y-3"},qt={class:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end"},Et={class:"flex gap-2 justify-end"},Gt={class:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3"},Wt={key:0,class:"mt-3 rounded-lg border bg-slate-50 p-3"},zt={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Kt={class:"flex justify-end gap-2"},Ht={key:0,class:"space-y-4"},Yt={class:"p-3 rounded-xl border bg-amber-50 border-amber-200 text-amber-900 text-sm"},Jt={class:"text-xs mt-1"},Qt={key:0},Xt={class:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm"},Zt={class:"p-3 border rounded-lg"},el={class:"font-semibold"},tl={class:"p-3 border rounded-lg"},ll={class:"font-semibold"},sl={class:"p-3 border rounded-lg"},ol={class:"font-semibold"},al={class:"flex items-center justify-between"},nl={class:"space-y-3"},dl={class:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end"},il={class:"flex gap-2 justify-end"},ul={class:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3"},rl={key:0,class:"mt-3 rounded-lg border bg-slate-50 p-3"},ml={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},pl={class:"flex justify-end gap-2"},Ll={__name:"Orders",props:{orders:Object,filters:Object,paymentMethods:{type:Array,default:()=>[]}},setup(n){var xe,ye,_e,ge,ke;const u=He(),k=n,V=f(((xe=k.filters)==null?void 0:xe.search)||""),D=f(((ye=k.filters)==null?void 0:ye.status)||""),q=f(((_e=k.filters)==null?void 0:_e.payment_status)||""),M=f((ge=k.filters)!=null&&ge.date_from?new Date(k.filters.date_from):null),O=f((ke=k.filters)!=null&&ke.date_to?new Date(k.filters.date_to):null),Se=[{label:"All",value:""},{label:"Completed",value:"completed"},{label:"Draft",value:"draft"},{label:"Void",value:"void"}],De=[{label:"All",value:""},{label:"Paid",value:"paid"},{label:"Partial",value:"partial"},{label:"Unpaid",value:"unpaid"}];function se(s){if(!s)return;const e=s.getFullYear(),S=String(s.getMonth()+1).padStart(2,"0"),c=String(s.getDate()).padStart(2,"0");return`${e}-${S}-${c}`}function oe(){T.get(route("pos.orders.index"),{search:V.value||void 0,status:D.value||void 0,payment_status:q.value||void 0,date_from:M.value?se(M.value):void 0,date_to:O.value?se(O.value):void 0},{preserveState:!0,replace:!0})}function $e(){V.value="",D.value="",q.value="",M.value=null,O.value=null,T.get(route("pos.orders.index"),{},{replace:!0})}function ae(s){s&&T.get(s,{},{preserveState:!0})}const ne=g(()=>{var s;return((s=k.orders)==null?void 0:s.data)||[]}),Pe=g(()=>ne.value.reduce((s,e)=>s+Number(e.total_amount||0),0));function R(s){return s?s.invoice_no||(s.status==="draft"?`DRAFT-${s.id}`:`#${s.id}`):""}function de(s){window.open(route("pos.orders.invoice",s.id),"_blank")}function ie(s){window.open(route("pos.orders.invoice",s.id)+"?autoprint=1","_blank")}function Te(s){return s==="paid"?"success":s==="partial"?"warn":"danger"}function Fe(s){return s==="completed"?"success":s==="draft"?"info":"danger"}const K=f(!1),C=f(null);function Ie(s){C.value=s,K.value=!0}function I(){return{id:st(),payment_method_id:null,amount:0,transaction_ref:"",notes:"",meta:{customer_bank_name:"",customer_account_no:"",received_to_bank_account_id:null,txn_ref:""}}}function ue(s){s.value.push(I())}function re(s,e){if(s.value.length===1){s.value=[I()];return}s.value.splice(e,1)}function H(s){const e=k.paymentMethods.find(c=>c.id===s.payment_method_id),S=((e==null?void 0:e.name)||"").toLowerCase();return S.includes("bank")||S.includes("transfer")}const B=f(!1),h=f(null),Y=f(!1);function Ae(s){return(s==null?void 0:s.status)!=="void"}function Ne(s){h.value=s,B.value=!0}function Me(){h.value&&(Y.value=!0,T.post(route("pos.orders.void",h.value.id),{},{preserveScroll:!0,onSuccess:()=>{u.add({severity:"success",summary:"Voided",detail:"Order has been voided",life:2200}),B.value=!1,h.value=null},onError:()=>{u.add({severity:"error",summary:"Failed",detail:"Could not void order",life:2500})},onFinish:()=>Y.value=!1}))}const j=f(!1),$=f(null),J=f(!1),A=f([I()]);function Oe(s){return(s==null?void 0:s.status)==="draft"}function Re(s){$.value=s,j.value=!0,A.value=[I()]}const Q=g(()=>{var s;return Number(((s=$.value)==null?void 0:s.total_amount)||0)}),me=g(()=>A.value.reduce((s,e)=>s+Number(e.amount||0),0)),X=g(()=>Math.max(0,Q.value-me.value)),Z=g(()=>Math.max(0,me.value-Q.value));function Be(s){if(!s)return null;const e={customer_bank_name:s.customer_bank_name||null,customer_account_no:s.customer_account_no||null,received_to_bank_account_id:s.received_to_bank_account_id||null,txn_ref:s.txn_ref||null};return Object.values(e).some(c=>c!==null)?e:null}function pe(s){const e=s.value.filter(c=>c.payment_method_id&&Number(c.amount||0)>0);if(!e.length)return u.add({severity:"warn",summary:"Payment required",detail:"Add at least one payment",life:2200}),null;for(const c of e)if(H(c)){const l=c.meta||{};if(!l.customer_bank_name||!l.customer_account_no)return u.add({severity:"warn",summary:"Bank info required",detail:"Customer bank name & account no are required for bank payments",life:2500}),null}return e.map(c=>{var l,m;return{payment_method_id:c.payment_method_id,amount:Number(c.amount),transaction_ref:((l=c.transaction_ref)==null?void 0:l.trim())||null,notes:((m=c.notes)==null?void 0:m.trim())||null,meta:Be(c.meta)}})}function je(){if(!$.value)return;const s=pe(A);s&&(J.value=!0,T.post(route("pos.orders.complete",$.value.id),{payments:s},{preserveScroll:!0,onSuccess:()=>{u.add({severity:"success",summary:"Completed",detail:"Draft order completed",life:2200}),j.value=!1,$.value=null},onError:()=>{u.add({severity:"error",summary:"Failed",detail:"Could not complete draft",life:2500})},onFinish:()=>J.value=!1}))}const L=f(!1),U=f(null),ee=f(!1),N=f([I()]);function Le(s){return s&&s.status!=="void"&&s.status!=="draft"&&(s.payment_status==="partial"||s.payment_status==="unpaid")}function qe(s){U.value=s,L.value=!0,N.value=[I()]}const ce=g(()=>{var s;return Number(((s=U.value)==null?void 0:s.total_amount)||0)}),ve=g(()=>{var s;return Number(((s=U.value)==null?void 0:s.paid_amount)||0)}),te=g(()=>Math.max(0,ce.value-ve.value)),fe=g(()=>N.value.reduce((s,e)=>s+Number(e.amount||0),0)),Ee=g(()=>Math.max(0,te.value-fe.value)),be=g(()=>Math.max(0,fe.value-te.value));function Ge(){if(!U.value)return;const s=pe(N);s&&(ee.value=!0,T.post(route("pos.orders.payments.store",U.value.id),{payments:s},{preserveScroll:!0,onSuccess:()=>{u.add({severity:"success",summary:"Payment added",detail:"Due updated successfully",life:2200}),L.value=!1,U.value=null},onError:()=>{u.add({severity:"error",summary:"Failed",detail:"Could not add payment",life:2500})},onFinish:()=>ee.value=!1}))}function We(s){s&&T.visit(route("pos.orders.edit",s.id))}return(s,e)=>{const S=Ke,c=ze;return p(),P(Je,null,{default:y(()=>[t("div",ot,[t("div",at,[e[18]||(e[18]=t("div",null,[t("h2",{class:"text-xl font-semibold flex items-center gap-2"},[t("i",{class:"pi pi-receipt text-primary"}),v(" POS Sales ")]),t("p",{class:"text-sm text-gray-500"}," View and manage Point of Sale orders ")],-1)),t("div",nt," Page Total: "+i(Pe.value.toFixed(2)),1)]),t("div",dt,[a(c,{class:"max-w-sm"},{default:y(()=>[a(S,null,{default:y(()=>e[19]||(e[19]=[t("i",{class:"pi pi-search"},null,-1)])),_:1}),a(o(w),{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=l=>V.value=l),placeholder:"Invoice / customer / cashier",class:"w-full",onKeyup:Ye(oe,["enter"])},null,8,["modelValue"])]),_:1}),a(o(W),{modelValue:D.value,"onUpdate:modelValue":e[1]||(e[1]=l=>D.value=l),options:Se,optionLabel:"label",optionValue:"value",placeholder:"Order Status",class:"w-full md:w-44"},null,8,["modelValue"]),a(o(W),{modelValue:q.value,"onUpdate:modelValue":e[2]||(e[2]=l=>q.value=l),options:De,optionLabel:"label",optionValue:"value",placeholder:"Payment Status",class:"w-full md:w-44"},null,8,["modelValue"]),a(o(we),{modelValue:M.value,"onUpdate:modelValue":e[3]||(e[3]=l=>M.value=l),placeholder:"From",dateFormat:"yy-mm-dd",showIcon:"",class:"w-full md:w-44"},null,8,["modelValue"]),a(o(we),{modelValue:O.value,"onUpdate:modelValue":e[4]||(e[4]=l=>O.value=l),placeholder:"To",dateFormat:"yy-mm-dd",showIcon:"",class:"w-full md:w-44"},null,8,["modelValue"]),a(o(r),{label:"Apply",icon:"pi pi-filter",class:"p-button-outlined",onClick:oe}),a(o(r),{label:"Reset",icon:"pi pi-refresh",class:"p-button-text",onClick:$e})]),t("div",it,[a(o(Qe),{value:ne.value,responsiveLayout:"scroll",size:"small",showGridlines:""},{default:y(()=>[a(o(F),{header:"Invoice"},{body:y(({data:l})=>[t("div",ut,[t("span",rt,i(R(l)),1),t("span",mt,i(new Date(l.created_at).toLocaleString()),1)])]),_:1}),a(o(F),{header:"Customer"},{body:y(({data:l})=>{var m;return[v(i(((m=l.customer)==null?void 0:m.name)||"Walk-in"),1)]}),_:1}),a(o(F),{header:"Cashier"},{body:y(({data:l})=>{var m;return[v(i(((m=l.user)==null?void 0:m.name)||"-"),1)]}),_:1}),a(o(F),{header:"Total"},{body:y(({data:l})=>[t("span",pt,i(Number(l.total_amount||0).toFixed(2)),1)]),_:1}),a(o(F),{header:"Payment"},{body:y(({data:l})=>[a(o(he),{value:l.payment_status,severity:Te(l.payment_status)},null,8,["value","severity"])]),_:1}),a(o(F),{header:"Status"},{body:y(({data:l})=>[a(o(he),{value:l.status,severity:Fe(l.status)},null,8,["value","severity"])]),_:1}),a(o(F),{header:"Actions"},{body:y(({data:l})=>[t("div",ct,[a(o(r),{icon:"pi pi-eye",class:"p-button-text p-button-sm",onClick:m=>Ie(l)},null,8,["onClick"]),a(o(r),{icon:"pi pi-external-link",class:"p-button-text p-button-sm",onClick:m=>de(l)},null,8,["onClick"]),l.status!=="void"?(p(),P(o(r),{key:0,icon:"pi pi-print",class:"p-button-text p-button-sm",onClick:m=>ie(l)},null,8,["onClick"])):x("",!0),Le(l)?(p(),P(o(r),{key:1,icon:"pi pi-wallet",class:"p-button-text p-button-sm p-button-warning",onClick:m=>qe(l)},null,8,["onClick"])):x("",!0),Oe(l)?(p(),P(o(r),{key:2,icon:"pi pi-check",class:"p-button-text p-button-sm p-button-success",onClick:m=>Re(l)},null,8,["onClick"])):x("",!0),l.status==="draft"?(p(),P(o(r),{key:3,icon:"pi pi-file-edit",class:"p-button-text p-button-sm p-button-info",onClick:m=>We(l)},null,8,["onClick"])):x("",!0),Ae(l)?(p(),P(o(r),{key:4,icon:"pi pi-ban",class:"p-button-text p-button-sm p-button-danger",onClick:m=>Ne(l)},null,8,["onClick"])):x("",!0)])]),_:1})]),_:1},8,["value"]),t("div",vt,[t("span",null,"Showing "+i(n.orders.from)+"–"+i(n.orders.to)+" of "+i(n.orders.total),1),t("div",ft,[a(o(r),{icon:"pi pi-angle-left",class:"p-button-text",disabled:!n.orders.prev_page_url,onClick:e[5]||(e[5]=l=>ae(n.orders.prev_page_url))},null,8,["disabled"]),a(o(r),{icon:"pi pi-angle-right",class:"p-button-text",disabled:!n.orders.next_page_url,onClick:e[6]||(e[6]=l=>ae(n.orders.next_page_url))},null,8,["disabled"])])])])]),a(o(E),{visible:K.value,"onUpdate:visible":e[9]||(e[9]=l=>K.value=l),modal:"",header:"Invoice Preview",style:{width:"760px"},breakpoints:{"960px":"75vw","640px":"95vw"}},{default:y(()=>{var l;return[C.value?(p(),_("div",bt,[t("div",xt,[t("div",null,[e[20]||(e[20]=t("div",{class:"text-sm text-gray-500"},"Invoice",-1)),t("div",yt,i(R(C.value)),1),t("div",_t,i(new Date(C.value.created_at).toLocaleString()),1)]),t("div",gt,[a(o(r),{label:"Open",icon:"pi pi-external-link",severity:"secondary",onClick:e[7]||(e[7]=m=>de(C.value))}),C.value.status!=="void"?(p(),P(o(r),{key:0,label:"Print",icon:"pi pi-print",class:"p-button-success",onClick:e[8]||(e[8]=m=>ie(C.value))})):x("",!0)])]),t("div",kt,[t("div",Vt,[e[21]||(e[21]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Customer ",-1)),t("div",Ct,i(((l=C.value.customer)==null?void 0:l.name)||"Walk-in"),1)]),t("div",wt,[e[22]||(e[22]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Summary ",-1)),t("div",null," Total: "+i(Number(C.value.total_amount||0).toFixed(2)),1),t("div",ht," Payment: "+i(C.value.payment_status),1),t("div",Ut," Status: "+i(C.value.status),1)])])])):x("",!0)]}),_:1},8,["visible"]),a(o(E),{visible:B.value,"onUpdate:visible":e[11]||(e[11]=l=>B.value=l),modal:"",header:"Void Order",style:{width:"520px"},breakpoints:{"960px":"75vw","640px":"95vw"}},{default:y(()=>[h.value?(p(),_("div",St,[e[26]||(e[26]=t("div",{class:"p-3 rounded-xl border bg-red-50 border-red-200 text-red-800 text-sm"},[t("div",{class:"font-bold"},"This will void the order."),t("div",{class:"text-xs mt-1"},[v(" If order is "),t("b",null,"completed"),v(", stock will be restored (your backend logic). ")])],-1)),t("div",Dt,[t("div",null,[e[23]||(e[23]=t("b",null,"Invoice:",-1)),v(" "+i(R(h.value)),1)]),t("div",null,[e[24]||(e[24]=t("b",null,"Total:",-1)),v(" "+i(Number(h.value.total_amount||0).toFixed(2)),1)]),t("div",null,[e[25]||(e[25]=t("b",null,"Status:",-1)),v(" "+i(h.value.status),1)])]),t("div",$t,[a(o(r),{label:"Cancel",class:"p-button-text",onClick:e[10]||(e[10]=l=>B.value=!1)}),a(o(r),{label:"Void Now",icon:"pi pi-ban",class:"p-button-danger",loading:Y.value,onClick:Me},null,8,["loading"])])])):x("",!0)]),_:1},8,["visible"]),a(o(E),{visible:j.value,"onUpdate:visible":e[14]||(e[14]=l=>j.value=l),modal:"",header:"Complete Draft",style:{width:"760px"},breakpoints:{"960px":"75vw","640px":"95vw"}},{default:y(()=>[$.value?(p(),_("div",Pt,[e[40]||(e[40]=t("div",{class:"p-3 rounded-xl border bg-emerald-50 border-emerald-200 text-emerald-800 text-sm"},[t("div",{class:"font-bold"},"Complete this draft order?"),t("div",{class:"text-xs mt-1"}," Add payments and bank info (if bank method). ")],-1)),t("div",Tt,[t("div",Ft,[e[27]||(e[27]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Invoice ",-1)),t("div",It,i(R($.value)),1)]),t("div",At,[e[28]||(e[28]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Total ",-1)),t("div",Nt,i(Q.value.toFixed(2)),1)]),t("div",Mt,[e[29]||(e[29]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Due / Change ",-1)),X.value>0?(p(),_("div",Ot," Due: "+i(X.value.toFixed(2)),1)):x("",!0),Z.value>0?(p(),_("div",Rt," Change: "+i(Z.value.toFixed(2)),1)):x("",!0),X.value===0&&Z.value===0?(p(),_("div",Bt," Balanced ")):x("",!0)])]),a(o(G)),t("div",jt,[e[30]||(e[30]=t("div",{class:"font-semibold"},"Payments",-1)),a(o(r),{label:"Add payment",icon:"pi pi-plus",class:"p-button-text",onClick:e[12]||(e[12]=l=>ue(A.value))})]),t("div",Lt,[(p(!0),_(Ve,null,Ce(A.value,(l,m)=>(p(),_("div",{key:l.id,class:"border rounded-xl p-3 bg-white"},[t("div",qt,[t("div",null,[e[31]||(e[31]=t("div",{class:"text-xs text-slate-500 mb-1"},[v(" Method "),t("span",{class:"text-red-600"},"*")],-1)),a(o(W),{modelValue:l.payment_method_id,"onUpdate:modelValue":d=>l.payment_method_id=d,options:n.paymentMethods,optionLabel:"name",optionValue:"id",placeholder:"Select method",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options"])]),t("div",null,[e[32]||(e[32]=t("div",{class:"text-xs text-slate-500 mb-1"},[v(" Amount "),t("span",{class:"text-red-600"},"*")],-1)),a(o(z),{modelValue:l.amount,"onUpdate:modelValue":d=>l.amount=d,min:0,class:"w-full",inputClass:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",Et,[a(o(r),{icon:"pi pi-trash",class:"p-button-text p-button-danger",onClick:d=>re(A.value,m)},null,8,["onClick"])])]),t("div",Gt,[t("div",null,[e[33]||(e[33]=t("div",{class:"text-xs text-slate-500 mb-1"}," Txn Ref ",-1)),a(o(w),{modelValue:l.transaction_ref,"onUpdate:modelValue":d=>l.transaction_ref=d,class:"w-full",placeholder:"Gateway / Slip ref (optional)"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[34]||(e[34]=t("div",{class:"text-xs text-slate-500 mb-1"}," Notes ",-1)),a(o(w),{modelValue:l.notes,"onUpdate:modelValue":d=>l.notes=d,class:"w-full",placeholder:"Optional note"},null,8,["modelValue","onUpdate:modelValue"])])]),l.payment_method_id&&H(l)?(p(),_("div",Wt,[e[39]||(e[39]=t("div",{class:"font-semibold text-sm mb-2"}," Bank Info (Required for bank) ",-1)),t("div",zt,[t("div",null,[e[35]||(e[35]=t("div",{class:"text-xs text-slate-500 mb-1"},[v(" Customer Bank Name "),t("span",{class:"text-red-600"},"*")],-1)),a(o(w),{modelValue:l.meta.customer_bank_name,"onUpdate:modelValue":d=>l.meta.customer_bank_name=d,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[36]||(e[36]=t("div",{class:"text-xs text-slate-500 mb-1"},[v(" Customer Account No "),t("span",{class:"text-red-600"},"*")],-1)),a(o(w),{modelValue:l.meta.customer_account_no,"onUpdate:modelValue":d=>l.meta.customer_account_no=d,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[37]||(e[37]=t("div",{class:"text-xs text-slate-500 mb-1"}," Received To Bank Account ID ",-1)),a(o(z),{modelValue:l.meta.received_to_bank_account_id,"onUpdate:modelValue":d=>l.meta.received_to_bank_account_id=d,class:"w-full",inputClass:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[38]||(e[38]=t("div",{class:"text-xs text-slate-500 mb-1"}," Bank Txn / Cheque No ",-1)),a(o(w),{modelValue:l.meta.txn_ref,"onUpdate:modelValue":d=>l.meta.txn_ref=d,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])])])):x("",!0)]))),128))]),a(o(G)),t("div",Kt,[a(o(r),{label:"Cancel",class:"p-button-text",onClick:e[13]||(e[13]=l=>j.value=!1)}),a(o(r),{label:"Complete Draft",icon:"pi pi-check",class:"p-button-success",loading:J.value,onClick:je},null,8,["loading"])])])):x("",!0)]),_:1},8,["visible"]),a(o(E),{visible:L.value,"onUpdate:visible":e[17]||(e[17]=l=>L.value=l),modal:"",header:"Pay Due",style:{width:"760px"},breakpoints:{"960px":"75vw","640px":"95vw"}},{default:y(()=>[U.value?(p(),_("div",Ht,[t("div",Yt,[e[44]||(e[44]=t("div",{class:"font-bold"},"Add payment for this sale",-1)),t("div",Jt,[e[42]||(e[42]=v(" Current Due: ")),t("b",null,i(te.value.toFixed(2)),1),e[43]||(e[43]=v(" • After Pay: ")),t("b",null,i(Ee.value.toFixed(2)),1),be.value>0?(p(),_("span",Qt,[e[41]||(e[41]=v(" • Change: ")),t("b",null,i(be.value.toFixed(2)),1)])):x("",!0)])]),t("div",Xt,[t("div",Zt,[e[45]||(e[45]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Invoice ",-1)),t("div",el,i(R(U.value)),1)]),t("div",tl,[e[46]||(e[46]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Total ",-1)),t("div",ll,i(ce.value.toFixed(2)),1)]),t("div",sl,[e[47]||(e[47]=t("div",{class:"text-xs text-gray-500 font-semibold"}," Already Paid ",-1)),t("div",ol,i(ve.value.toFixed(2)),1)])]),a(o(G)),t("div",al,[e[48]||(e[48]=t("div",{class:"font-semibold"},"Payments",-1)),a(o(r),{label:"Add payment",icon:"pi pi-plus",class:"p-button-text",onClick:e[15]||(e[15]=l=>ue(N.value))})]),t("div",nl,[(p(!0),_(Ve,null,Ce(N.value,(l,m)=>(p(),_("div",{key:l.id,class:"border rounded-xl p-3 bg-white"},[t("div",dl,[t("div",null,[e[49]||(e[49]=t("div",{class:"text-xs text-slate-500 mb-1"},[v(" Method "),t("span",{class:"text-red-600"},"*")],-1)),a(o(W),{modelValue:l.payment_method_id,"onUpdate:modelValue":d=>l.payment_method_id=d,options:n.paymentMethods,optionLabel:"name",optionValue:"id",placeholder:"Select method",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options"])]),t("div",null,[e[50]||(e[50]=t("div",{class:"text-xs text-slate-500 mb-1"},[v(" Amount "),t("span",{class:"text-red-600"},"*")],-1)),a(o(z),{modelValue:l.amount,"onUpdate:modelValue":d=>l.amount=d,min:0,class:"w-full",inputClass:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",il,[a(o(r),{icon:"pi pi-trash",class:"p-button-text p-button-danger",onClick:d=>re(N.value,m)},null,8,["onClick"])])]),t("div",ul,[t("div",null,[e[51]||(e[51]=t("div",{class:"text-xs text-slate-500 mb-1"}," Txn Ref ",-1)),a(o(w),{modelValue:l.transaction_ref,"onUpdate:modelValue":d=>l.transaction_ref=d,class:"w-full",placeholder:"Gateway / Slip ref (optional)"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[52]||(e[52]=t("div",{class:"text-xs text-slate-500 mb-1"}," Notes ",-1)),a(o(w),{modelValue:l.notes,"onUpdate:modelValue":d=>l.notes=d,class:"w-full",placeholder:"Optional note"},null,8,["modelValue","onUpdate:modelValue"])])]),l.payment_method_id&&H(l)?(p(),_("div",rl,[e[57]||(e[57]=t("div",{class:"font-semibold text-sm mb-2"}," Bank Info (Required for bank) ",-1)),t("div",ml,[t("div",null,[e[53]||(e[53]=t("div",{class:"text-xs text-slate-500 mb-1"},[v(" Customer Bank Name "),t("span",{class:"text-red-600"},"*")],-1)),a(o(w),{modelValue:l.meta.customer_bank_name,"onUpdate:modelValue":d=>l.meta.customer_bank_name=d,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[54]||(e[54]=t("div",{class:"text-xs text-slate-500 mb-1"},[v(" Customer Account No "),t("span",{class:"text-red-600"},"*")],-1)),a(o(w),{modelValue:l.meta.customer_account_no,"onUpdate:modelValue":d=>l.meta.customer_account_no=d,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[55]||(e[55]=t("div",{class:"text-xs text-slate-500 mb-1"}," Received To Bank Account ID ",-1)),a(o(z),{modelValue:l.meta.received_to_bank_account_id,"onUpdate:modelValue":d=>l.meta.received_to_bank_account_id=d,class:"w-full",inputClass:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[56]||(e[56]=t("div",{class:"text-xs text-slate-500 mb-1"}," Bank Txn / Cheque No ",-1)),a(o(w),{modelValue:l.meta.txn_ref,"onUpdate:modelValue":d=>l.meta.txn_ref=d,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])])])):x("",!0)]))),128))]),a(o(G)),t("div",pl,[a(o(r),{label:"Cancel",class:"p-button-text",onClick:e[16]||(e[16]=l=>L.value=!1)}),a(o(r),{label:"Submit Payment",icon:"pi pi-check",class:"p-button-warning",loading:ee.value,onClick:Ge},null,8,["loading"])])])):x("",!0)]),_:1},8,["visible"])]),_:1})}}};export{Ll as default};
